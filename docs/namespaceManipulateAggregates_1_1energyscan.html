<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ManipulateAggregates: Package ManipulateAggregates.energyscan</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="namespacemembers.html"><span>Package&nbsp;Functions</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceManipulateAggregates.html">ManipulateAggregates</a>.<a class="el" href="namespaceManipulateAggregates_1_1energyscan.html">energyscan</a>
  </div>
</div>
<div class="contents">
<h1>Package ManipulateAggregates.energyscan</h1>
<p>Create low-energy aggregates from molecules.  
<a href="#_details">More...</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Packages</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">package &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceManipulateAggregates_1_1energyscan_1_1minimasearch.html">minimasearch</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Search for local energy minimum geometries. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">package &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceManipulateAggregates_1_1energyscan_1_1scan.html">scan</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Systematically determine <a class="el" href="namespaceManipulateAggregates_1_1aggregate.html" title="Definitions of the agg class and some auxilliary function.">aggregate</a> energies. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">package &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceManipulateAggregates_1_1energyscan_1_1similarityscreening.html">similarityscreening</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Screen <a class="el" href="namespaceManipulateAggregates_1_1aggregate.html" title="Definitions of the agg class and some auxilliary function.">aggregate</a> geometries with respect to similarity. </p>
<br/></td></tr>
</p>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Create low-energy aggregates from molecules. </p>
<p>This is the submodule <a class="el" href="namespaceManipulateAggregates_1_1energyscan.html" title="Create low-energy aggregates from molecules.">energyscan</a>. It estimates energetically favourable <a class="el" href="namespaceManipulateAggregates_1_1aggregate.html" title="Definitions of the agg class and some auxilliary function.">aggregate</a> (dimers and higher ones) geometries in a three-step procedure.</p>
<ol type="1">
<li>create a huge number of aggregates:<ul>
<li>implemented in <a class="el" href="namespaceManipulateAggregates_1_1energyscan_1_1scan.html" title="Systematically determine aggregate energies.">ManipulateAggregates.energyscan.scan</a></li>
<li>Keep a central molecule fixed and</li>
<li>move another molecule around the central one (varying orientations) and</li>
<li>evaluate energy for every <a class="el" href="namespaceManipulateAggregates_1_1aggregate.html" title="Definitions of the agg class and some auxilliary function.">aggregate</a> created (so far: using force fields).</li>
<li>molecules can be replaced by entire aggregates</li>
</ul>
</li>
<li>search for local energy minima among the aggregates created in the previous step<ul>
<li>implemented in <a class="el" href="namespaceManipulateAggregates_1_1energyscan_1_1minimasearch.html" title="Search for local energy minimum geometries.">ManipulateAggregates.energyscan.minimasearch</a></li>
</ul>
</li>
<li>screen all of those local energy minimum structures to obtain a highly diverse set<ul>
<li>implemented in <a class="el" href="namespaceManipulateAggregates_1_1energyscan_1_1similarityscreening.html" title="Screen aggregate geometries with respect to similarity.">ManipulateAggregates.energyscan.similarityscreening</a></li>
</ul>
</li>
</ol>
<p>It requires a slightly modified version of OpenBabel (<a href="https://github.com/razziel89/openbabel">https://github.com/razziel89/openbabel</a>) including its Python bindings (incorporation into the official version is still a work-in-progress). It also requires libFireDeamon (<a href="https://github.com/razziel89/libfiredeamon">https://github.com/razziel89/libfiredeamon</a>) and its Python bindings.</p>
<p>It currently uses OpenBabel's force fields to estimate <a class="el" href="namespaceManipulateAggregates_1_1aggregate.html" title="Definitions of the agg class and some auxilliary function.">aggregate</a> energies. Please see the global help text variable <a class="el" href="namespaceenergyscan.html#a92851df57a3a44d496379690408af905" title="the long help text message (also a default config file)">energyscan.LONGHELPTEXT</a> for a more detailed description.</p>
<p>Parallelization is supported for some subsubmodules. Set the environment variable OMP_NUM_THREADS to the value you want to use. Only single-node parallelization is supported as of now. Multi-node parallelization is supported via "FireDeamon" (see <a href="https://github.com/razziel89/firedeamon,">https://github.com/razziel89/firedeamon,</a> will be published early in 2017).</p>
<dl class="user"><dt><b>Details</b></dt><dd></dd></dl>
<p>The generation of low-energy aggregates is a three-step procedure. The first step is a volumetric energy <a class="el" href="namespaceManipulateAggregates_1_1energyscan_1_1scan.html" title="Systematically determine aggregate energies.">scan</a>: first, two regular three-dimensional grids are generated, the molecules’ main axes are aligned with the three Cartesian axes and they are centered at the origin. Then, one of the molecules is kept fixed while the other’s center is moved to every point on the first, i.e., spatial grid and the aggregate’s energy is evaluated. Afterwards, the second molecule is rotated according to Euler angles around its main axes defined by the second, i.e., angular grid and the <a class="el" href="namespaceManipulateAggregates_1_1energyscan_1_1scan.html" title="Systematically determine aggregate energies.">scan</a> is repeated for every such orientation. I greatly improved the speed of this brute-force approach by excessive screening of vdW-overlaps and aggregates, whose vdW surfaces are farther apart than a given distance (here: 2.5 Å). I remark that this screening has to be performed for every angular arrangement independently and only very few points can be screened right at the start, i.e., those inside and slightly outside the vdW-surface of the central molecule.</p>
<p>The second step is the search for geometries corresponding to local energy minima for each angular arrangement: I define a local minimum spatial point as such a point, whose associated <a class="el" href="namespaceManipulateAggregates_1_1aggregate.html" title="Definitions of the agg class and some auxilliary function.">aggregate</a> has an energy lower than that of every other point in its neighborhood. Given a definition for “neighborhood”, a neighbor list is generated associating each point with its neighbors allowing for treating irregular grids just like regular ones. This list is then used to determine all local energy minima by simple comparison of the stored volumetric data.</p>
<p>The third step is the selection of the desired number of highly diverse low-energy <a class="el" href="namespaceManipulateAggregates_1_1aggregate.html" title="Definitions of the agg class and some auxilliary function.">aggregate</a> geometries: first, the programme discards all those remaining geometries whose energy, possibly obtained using a different method than before, is higher than a given cutoff. Geometrical similarity is then estimated by computing the RMSD between two aggregates after they were again aligned to the origin and the three Cartesian axes. In order to minimize the required number of RMSD computations, I use a tree-based algorithm as implemented in OpenBabel. This algorithm, however, is designed to quickly extract such geometries from a given set, whose RMSDs with respect to each other are all larger than a given cutoff, without storing pairwise RMSDs. In order to obtain a small number of highly diverse dimers, the aforementioned cutoff is increased step by step, thereby successively reducing the number of dimers until there is at most the desired number of them left.</p>
<p>The aggregates’ energies were evaluated using force-fields as implemented in the OpenBabel chemical toolbox. Technically, every energy evaluation method could be used for this algorithm. However, the great advantage of force-fields is the high speed of energy evaluations as compared to, for example, density functional theory calculations. The great disadvantage of force-fields is undoubtedly that some bonds might not be parameterized correctly for newly synthesized molecules. Since this algorithm evaluates differences only in intermolecular interactions, I believe it to be accurate enough to determine starting structures for further treatment as the here described algorithm is only the first step in the computational generation of higher aggregates (described elsewhere, not yet published). In order to avoid the generation of false low-energy local minimum aggregates, the resulting structures should be quantum chemically optimized in a final step. </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 5 Jan 2017 for ManipulateAggregates by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
